{% if section.settings.header_bg != blank %}
  <section class="ambassadors-hero">
    <div class="container-fluid p-0">
      {% if section.settings.header_bg != blank %}
      <div class="ambassadors-hero-bg" style="background-image: url('{{ section.settings.header_bg | img_url: '2000x'  }}');">
        <h1>{{ section.settings.hero-banner-heading }}</h1> 
      </div>
      {% endif %}
    </div>
  </section>
{% endif %}

  <div class="ambassadors-container">
    <div class="left-side-icons left-side-icons-container">
      <div class="ambassadors-vertical-slider">
        {% for block in section.blocks %}
        <div id="block--{{ block.id }}a" class="profiles">
          <a href="#block--{{ block.id }}">
            {% if block.settings.amabsador_picture != blank %}
            <div class="profile-pic">
              <img src="{{ block.settings.amabsador_picture | img_url: '100x' }}" alt="">
            </div>    
            {% endif %}
          {% if block.settings.title != blank %}
            <div class="profile-name">{{ block.settings.title }}</div>
          {% endif %}
        </a>
        </div>  
        {% endfor %}
        <div id="block--{{ block.id }}a" class="profiles"></div>
      </div>
    </div> 
    <div class="ambassadors-section">
      {%- assign color = "white" -%}
      {% for block in section.blocks %}
        <div class="ambsdr-block-wrapper" id="block--{{ block.id }}">
          {%- if color == "white" -%}
          {%- assign color = "black" -%}
            <section class="section-1">
              <div class="container-fluid">
                <div class="row">
                  <div class="col-md-7">
                    <div class="profile-wrap">
                      <div class="profile-img">
                        {% if block.settings.amabsador_picture != blank %}
                        <div class="img-bg" style="background-image: url('{{ block.settings.amabsador_picture | img_url: '800x' }}');"></div>
                        {% endif %}
                        <div class="social-media-icons">
                          {% if block.settings.facebook != blank %}
                            <a href="{{ block.settings.facebook }}" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
                          {% endif %}
                          {% if block.settings.insta != blank %}
                            <a href="{{ block.settings.insta }}" target="_blank"><i class="fa fa-instagram" aria-hidden="true"></i></a>
                          {% endif %}
                          {% if block.settings.twitter != blank %}
                            <a href="{{ block.settings.twitter }}" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
                          {% endif %}
                        </div>
                      </div>
                      <div class="profile-info">
                        {% unless block.settings.title == blank %}
                          <h3 data-splitting="lines" data-scroll class="delay title">{{ block.settings.title }}</h3>
                        {% endunless %}
                        {% unless block.settings.subtitle == blank %}
                            <div class="yellow-text" data-aos="fade-up">{{ block.settings.subtitle }}</div>
                        {% endunless %}
                        {% unless block.settings.text == blank %}
                            <p class="about-info" data-aos="fade-up">{{ block.settings.text }}</p>
                        {% endunless %}
                        <div class="ambassadors-cta">
                          <div class="int-xxs-b-4 int-xxs-r-4 int-md-t-4 int-md-b-6 int-sm-r-3">
                            <a href="#ambassadors-popup--{{ block.id }}" data-aos="fade-up" class="ambassadors-popup btn-outline full-width">LEARN MORE</a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-5">
                    <div class="photo-graphy position-relative">
                      <div class="vertical-text">{{ block.settings.profile_caption }}</div>
                      <div class="img-wrap">
                        {% if block.settings.profile_picture != blank %}
                        <div class="img-bg" data-aos="fade-up" data-aos-delay="100" style="background-image: url('{{ block.settings.profile_picture | img_url: '400x' }}');"></div>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </section>
            {% if block.settings.collection != blank %}
            <section class="collection-section">
              <div class="container-fluid">
                <div class="row collection-wrap">
                  <div class="col-md-12 p-0">
                    <div class="collection-items-wrap position-relative">
                      <div data-splitting="lines" data-scroll class="delay collection-title">{{ block.settings.collection_title }}</div>
                      <div class="products-slider">
                      {% for product in collections[block.settings.collection].products %}
                          <div class="collection-item position-relative">
                            <div class="product-details">
                              <h4 class="product-title">{{ product.title }}</h4>
                              {% assign handle = product.handle | remove: 'the-' %}
                              {% assign icon = 'icon-' | append: handle %}
                              {% if product.type == 'board' %}
                                <div class="product-icon">
                                  {% include icon %}
                                </div>
                              {% endif %}
                            </div>
                            <div class="product-img">
                              <a href="{{ product.url }}" class="img-bg" style="background-image: url('{{ product.featured_image | img_url: '800x' }}');"></a>
                            </div>
                          </div>
                      {% endfor %}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </section>
            {% endif %}
          {%- elsif color == "black" -%}
          {%- assign color = "white" -%}
          {%- comment -%}
          style="background-image: url({{ 'bonsai-solid-h-2.png' | asset_url }})"
          {%- endcomment -%}
            <section class="bottom-sec bg-black"  >
              <div class="container-fluid">
                <div class="row">
                  <div class="col-md-5">
                    <div class="photo-graphy position-relative">
                      <div class="vertical-text">{{ block.settings.profile_caption }}</div>
                      <div class="img-wrap">
                        {% if block.settings.profile_picture != blank %}
                        <div class="img-bg" data-aos="fade-up" data-aos-delay="100" style="background-image: url('{{ block.settings.profile_picture | img_url: '400x' }}');"></div>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                  <div class="col-md-7">
                    <div class="profile-wrap ambassador-page">
                      <div class="profile-info">
                      {% if block.settings.title != blank %}
                        <h3 data-splitting="lines" data-scroll class="delay title">{{ block.settings.title }}</h3>  
                      {% endif %}
                      {% if block.settings.subtitle != blank %}
                          <div class="yellow-text">{{ block.settings.subtitle }}</div>
                      {% endif %}
                      {% if block.settings.text != blank %}
                          <p class="about-info">{{ block.settings.text }}</p>
                      {% endif %}
                      <div class="ambassadors-cta">
                        <div class="int-xxs-b-4 int-xxs-r-4 int-md-t-4 int-md-b-6 int-sm-r-3">
                          <a href="#ambassadors-popup--{{ block.id }}" class="ambassadors-popup btn-outline full-width">LEARN MORE</a>
                        </div>
                      </div>
                      </div>
                      <div class="profile-img">
                        {% if block.settings.amabsador_picture != blank%}
                        <div class="img-bg" style="background-image: url('{{ block.settings.amabsador_picture | img_url: '600x' }}');"></div>
                        {% endif %}
                        <div class="social-media-icons">
                          {% if block.settings.facebook != blank %}
                            <a href="{{ block.settings.facebook }}"><i class="fa fa-facebook" aria-hidden="true"></i></a>
                          {% endif %}
                          {% if block.settings.insta != blank %}
                            <a href="{{ block.settings.insta }}"><i class="fa fa-instagram" aria-hidden="true"></i></a>
                          {% endif %}
                          {% if block.settings.twitter != blank %}
                            <a href="{{ block.settings.twitter }}"><i class="fa fa-twitter" aria-hidden="true"></i></a>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            
                <div class="collection-section container-fluid">
                  <div class="row collection-wrap">
                    <div class="col-md-12 p-0">
                      <div class="collection-items-wrap position-relative">
                        <div data-splitting="lines" data-scroll class="delay collection-title-btm">{{ block.settings.collection_title }}</div>
                        <div class="products-slider">
                        {% for product in collections[block.settings.collection].products limit: 2 %}
                          <div class="collection-item position-relative">
                            <div class="product-details">
                              <h4 class="product-title">{{ product.title }}</h4>
                              {% assign handle = product.handle | remove: 'the-' %}
                              {% assign icon = 'icon-' | append: handle %}
                              {% if product.type == 'board' %}
                                <div class="product-icon">
                                  {% include icon %}
                                </div>
                              {% endif %}
                            </div>
                            <div class="product-img">
                              {% if product.featured_image != blank %}
                              <a href="{{ product.url }}" class="img-bg" style="background-image: url('{{ product.featured_image | img_url: '800x' }}');"></a>
                              {% endif %}
                            </div>
                          </div>
                      {% endfor %}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
            </section>
          {%- endif -%}
          <div id="ambassadors-popup--{{ block.id }}" class="white-popup mfp-hide ambassadors-popup-wrapper">

            <div class="ambassadors-popup-slider"> 
              {% for i in (1..5) %}
              {% capture image %}popup_image{{ i }}{% endcapture %}
              {% if block.settings[image] != blank %}
              <div class="" >
                <div class="" style="display:flex;align-items: center;">
                  <div class="item col-md-6" style="background-image: url({{ block.settings[image] | img_url: '700x' }});"></div>
                  {% capture text %}popup_text{{ i }}{% endcapture %}
                  {% capture heading %}popup_text_heading{{ i }}{% endcapture %}
                  <div class="ambassadors-popup-text col-md-6">
                    <div class="yellow-text popup-text-heading">{{ block.settings[heading] }}</div>
                    <p>{{ block.settings[text] }}</p>
                  </div>
                </div>
              </div>
              {% endif %}
              {% endfor %}
              {% if block.settings.popup_video != blank %}
              <div class="" >
                <div class="" style="display:flex;align-items: center;">
                  <div class="item col-md-6" data-adsasd="{{ block.settings.popup_video.id }}">
                    {% if block.settings.popup_video.type == 'youtube' %}
                    <iframe id="video" src="//www.youtube.com/embed/{{ block.settings.popup_video.id }}?&playsinline=1&mute=1&loop=1"
                    frameborder="0" allowfullscreen></iframe>
                    {% else %}
                    <iframe src="https://player.vimeo.com/video/{{ block.settings.popup_video.id }}" width="100%" height="360" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>
                    {% endif %}     
                  </div>        
                  <div class="ambassadors-popup-text col-md-6">
                    <div class="yellow-text popup-text-heading">{{ block.settings.popup_video_heading }}</div>
                    <p>{{ block.settings.popup_video_text }}</p>
                  </div>
                </div>
              </div>       
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
<style>
  html {
    scroll-behavior: smooth;
  }
  .ambassadors-popup-text {
    font-size: .8rem;
    line-height: 160%;
    font-weight: 400;
    padding: 0 20px;
    text-align: center;
  }
  .white-popup.ambassadors-popup-wrapper {
      position: relative;
      background: #fff;
      padding: 30px;
      width: auto;
      max-width: 1000px;
      margin: 20px auto;
  }
  .white-popup.ambassadors-popup-wrapper .row {
    margin-left:-30px;
    margin-right:-30px;
  }
  .white-popup.ambassadors-popup-wrapper .row >div{ 
    padding-left:30px;
    padding-right:30px;
  }
  .ambassadors-popup-wrapper .row.align-items-center {
    align-items: center;
  }
  .ambassadors-popup-slider .item {
    position: relative;
    background-position: center;
    background-size: cover;
    background-repeat: no-repeat;
    padding: 220px  0;
  }
  .ambassadors-popup-slider .item iframe{ 
    position: absolute;
    left:0;
    top:0;
    width: 100%;
    height: 100%;
  }
  .ambassadors-popup-wrapper .slick-dots{
    display: flex;
    justify-content: center;
    margin-top: 10px;
  }
  .ambassadors-popup-wrapper .slick-dots li {
    margin-right: 20px;
  }
  .ambassadors-popup-wrapper .slick-dots li button {
    background: #000;
    border-radius: 50%;
    font-size: 0;
    width: 20px !important;
    height: 20px !important;
    padding: 0;
  }
  .ambassadors-popup-wrapper .slick-dots li.slick-active button {
    border:2px solid #ac8b33;
    background: #fff;
  }
  .yellow-text.popup-text-heading {
    font-family: nimbus-sans-extended,sans-serif;
    font-size: 22px;
    color: #ac8b33;
    margin: 15px 0;
  }
</style>

<script>

  function sidebar_sticky_relocate(){
    var width = (window.innerWidth > 0) ? window.innerWidth : screen.width;

    var window_top = $(window).scrollTop();
    var div_top = $('.ambassadors-section').offset().top;

    console.log('sidebar_sticky_relocate')

    if (width > 768) {
  
      let filter_sidebar = $('.left-side-icons.left-side-icons-container');

      if (window_top > div_top) {
        filter_sidebar.addClass('is_sticky');
        filter_sidebar.css({top: '50%'});
      } else {
        filter_sidebar.removeClass('is_sticky');
        filter_sidebar.css({top: 0});
      }
    }
  }


var direction = 0; // a variable to keep track of scrolled position;
$(window).on('scroll', function() {
  // check if window is scrolling up or down;
  if ($(window).scrollTop() > direction) { // if true, window scrolling scrolling down;
    $('.left-side-icons').find('.profiles').removeClass('active'); // remove active class from all anchors

    var downIndex = $('.ambassadors-section').find('.ambsdr-block-wrapper').filter(function(index) {
        return this.getBoundingClientRect().y <= (window.innerHeight / 2) && this.getBoundingClientRect().y + this.getBoundingClientRect().height > window.innerHeight / 2;
    }).index();
    console.log('downIndex = ', downIndex);

    if (downIndex >= 0) {
      $('.left-side-icons').find('.profiles').eq(downIndex).addClass('active');

      var slideindex = $('.left-side-icons').find('.profiles').eq(downIndex).attr('data-slick-index');
      $('.ambassadors-vertical-slider').slick('slickGoTo', slideindex);
    }

    // update the current scroll position now;
    direction = $(window).scrollTop();

  } else { // if false, window scrolling scrolling up;
    $('.left-side-icons').find('.profiles').removeClass('active'); // remove active class from all anchors

    var upIndex = $('.ambassadors-section').find('.ambsdr-block-wrapper').filter(function(index) {
        return this.getBoundingClientRect().y < (window.innerHeight / 2) && this.getBoundingClientRect().y + this.getBoundingClientRect().height > window.innerHeight / 2;
    }).index();
    console.log('upIndex = ', upIndex);

    if (upIndex >= 0) {
      $('.left-side-icons').find('.profiles').eq(upIndex).addClass('active');

      var slideindex = $('.left-side-icons').find('.profiles').eq(upIndex).attr('data-slick-index');
      $('.ambassadors-vertical-slider').slick('slickGoTo', slideindex);
    }

    // update the current scroll position now;
    direction = $(window).scrollTop();
  }

  sidebar_sticky_relocate();
});

$(document).ready(function(){      
  
  // $('.left-side-icons .profiles').click(function(){
  //   $('.left-side-icons .profiles').removeClass('active');
  //   $(this).closest('div').addClass('active');
  // });

  $('.ambassadors-popup-slider').slick({
      dots: true,
      infinite: true,
      speed: 300,
      slidesToShow: 1,
      slidesToScroll: 1,
      arrows: false,
      
    });
    $('.ambassadors-vertical-slider').slick({
      autoPlay:true,
      dots: false,
      arrows: true,
      vertical: true,
      slidesToShow: 5,
      centerMode: false,
      infinite: false,
      responsive: [
        {
          breakpoint: 1400,
          settings: {
            slidesToShow: 4,
          }
        }
        // You can unslick at a given breakpoint now by adding:
        // settings: "unslick"
        // instead of a settings object
      ]
    });

  $('.products-slider').slick({
      dots: false,
      infinite: true,
      speed: 300,
      slidesToShow: 2,
      slidesToScroll: 1,
      arrows: true,
      centerMode: true,
      responsive: [
        {
          breakpoint: 1024,
          settings: {
            slidesToShow: 2,
            slidesToScroll: 1,
            infinite: true,
            dots: false
          }
        },
        {
          breakpoint: 767,
          settings: {
            slidesToShow: 1,
            slidesToScroll: 1
          }
        }
        // You can unslick at a given breakpoint now by adding:
        // settings: "unslick"
        // instead of a settings object
      ]
    });
})

$('.ambassadors-popup').magnificPopup({
  type:'inline',
  midClick: true,
  callbacks:{
    open: function() {
    $('.ambassadors-popup-slider').slick('slickGoTo',0);
    //window.dispatchEvent(new Event('resize'));
    },
  } 
});


$(window).load(function() {
  sidebar_sticky_relocate();
});
</script>

  {% schema %}
      {
          "name": "Ambassadors",
            "settings": [
                {
                    "type": "header",
                    "content": "Header"
                },
                {
                    "type": "image_picker",
                    "id": "header_bg",
                    "label": "Banner Image"
                },
                {
                  "type": "text",
                  "id": "hero-banner-heading",
                  "label": "Hero banner Heading"
              }
          ],
          "blocks":[
                {
                    "name":"Ambasador",
                    "type":"ambassador",
                    "settings":[
                        {
                            "type": "image_picker",
                            "id": "profile_picture",
                            "label": "Profile Picture"
                        },
                        {
                            "type": "text",
                            "id": "profile_caption",
                            "label": "Profile Picture Caption"
                        },
                        {
                            "type": "image_picker",
                            "id": "amabsador_picture",
                            "label": "Amabsador Picture"
                        },
                        {
                            "type": "text",
                            "id": "title",
                            "label": "Title"
                        },
                        {
                            "type": "text",
                            "id": "subtitle",
                            "label": "Subtitle"
                        },
                        {
                            "type": "textarea",
                            "id": "text",
                            "label": "Text"
                        },
                        {
                            "type": "text",
                            "id": "collection_title",
                            "label": "Collection Title"
                        },
                        {
                            "type": "collection",
                            "id": "collection",
                            "label": "Collection"
                        },
                        {
                          "type": "header",
                          "content": "Social Icons"
                        },
                        {
                          "type": "text",
                          "id": "facebook",
                          "label": "Facebook"
                        },
                        {
                          "type": "text",
                          "id": "insta",
                          "label": "Instagram"
                        },
                        {
                          "type": "text",
                          "id": "twitter",
                          "label": "Twitter"
                        },
                        {
                          "type": "header",
                          "content": "PopUp"
                        },
                        {
                          "type": "textarea",
                          "id": "popup_text",
                          "label": "Text"
                        },
                        {
                          "type": "video_url",
                          "id": "popup_video",
                          "accept": [
                            "youtube",
                            "vimeo"
                          ],
                          "label": "Video"
                        },
                        {
                          "type": "text",
                          "id": "popup_video_heading",
                          "label": "Popup Video Heading"
                        },
                        {
                          "type": "textarea",
                          "id": "popup_video_text",
                          "label": "Text"
                        },
                        {
                          "type": "image_picker",
                          "id": "popup_image1",
                          "label": "Image 1"
                        },
                        {
                          "type": "text",
                          "id": "popup_text_heading1",
                          "label": "Popup Text Heading"
                        },
                        {
                          "type": "textarea",
                          "id": "popup_text1",
                          "label": "Text"
                        },
                        {
                          "type": "image_picker",
                          "id": "popup_image2",
                          "label": "Image 2"
                        },
                        {
                          "type": "text",
                          "id": "popup_text_heading2",
                          "label": "Popup Text Heading"
                        },
                        {
                          "type": "textarea",
                          "id": "popup_text2",
                          "label": "Text"
                        },
                        {
                          "type": "image_picker",
                          "id": "popup_image3",
                          "label": "Image 3"
                        },
                        {
                          "type": "text",
                          "id": "popup_text_heading3",
                          "label": "Popup Text Heading"
                        },
                        {
                          "type": "textarea",
                          "id": "popup_text3",
                          "label": "Text"
                        }
                    ]
                }
          ]
      }
  {% endschema %}
  